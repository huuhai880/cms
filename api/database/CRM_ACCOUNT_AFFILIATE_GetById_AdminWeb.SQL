SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[CRM_ACCOUNT_AFFILIATE_GetById_AdminWeb]
    @MEMBERID BIGINT = 10009
AS
BEGIN
    SELECT 
            CRM_ACCOUNT.MEMBERID,
            CRM_ACCOUNT.CUSTOMERCODE,
            CRM_ACCOUNT.MEMBERID AS VALUE,
            CONCAT(CRM_ACCOUNT.CUSTOMERCODE, '-', CRM_ACCOUNT.FULLNAME) AS LABEL,
            CRM_ACCOUNT.FULLNAME,
            CRM_ACCOUNT.EMAIL,
            CRM_ACCOUNT.PHONENUMBER,
            CRM_ACCOUNT.PROVINCEID,
            CRM_ACCOUNT.DISTRICTID,
            CRM_ACCOUNT.WARDID,
            CRM_ACCOUNT.ADDRESS,
            IIF(CRM_ACCOUNT.BIRTHDAY IS NOT NULL, FORMAT(CRM_ACCOUNT.BIRTHDAY, 'dd/MM/yyyy'), '') BIRTHDAY,
            CRM_ACCOUNT.IDCARD,
            CRM_ACCOUNT.IDCARDBACKSIDE,
            CRM_ACCOUNT.IDCARDFRONTSIDE,
            CRM_ACCOUNT.LIVEIMAGE,
            IIF(CRM_ACCOUNT.IDCARDDATE IS NOT NULL, FORMAT(CRM_ACCOUNT.IDCARDDATE, 'dd/MM/yyyy'), '') IDCARDDATE,
            CRM_ACCOUNT.IDCARDPLACE,
            CRM_ACCOUNT.AFFILIATETYPEID,
            CRM_ACCOUNT.ISAGREE,
            IIF(CRM_ACCOUNT.REGISTRATIONDATE IS NOT NULL, FORMAT(CRM_ACCOUNT.REGISTRATIONDATE, 'dd/MM/yyyy'), '') REGISTRATIONDATE,
            CRM_ACCOUNT.ISACTIVE,
            CRM_ACCOUNT.REVIEWNOTE,
            CRM_ACCOUNT.STATUSAFFILIATE,
            CRM_ACCOUNT.LEADERID
    FROM    CRM_ACCOUNT
    WHERE   CRM_ACCOUNT.ISDELETED = 0
    AND     CRM_ACCOUNT.MEMBERID = @MEMBERID
    AND     CRM_ACCOUNT.REGISTRATIONDATE IS NOT NULL
    AND     CRM_ACCOUNT.STATUSAFFILIATE IS NOT NULL

END
GO
