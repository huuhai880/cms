ALTER PROCEDURE CRM_ACCOUNT_Affiliate_Init_AdminWeb
AS
BEGIN
    --DANH SACH MEMBER
    SELECT 
            CRM_ACCOUNT.MEMBERID,
            CRM_ACCOUNT.CUSTOMERCODE,
            CRM_ACCOUNT.MEMBERID AS VALUE,
            CONCAT(CRM_ACCOUNT.CUSTOMERCODE, '-', CRM_ACCOUNT.FULLNAME) AS LABEL,
            CRM_ACCOUNT.FULLNAME,
            CRM_ACCOUNT.EMAIL,
            CRM_ACCOUNT.PHONENUMBER,
            CRM_ACCOUNT.PROVINCEID,
            CRM_ACCOUNT.DISTRICTID,
            CRM_ACCOUNT.WARDID,
            CRM_ACCOUNT.ADDRESS,
            IIF(CRM_ACCOUNT.BIRTHDAY IS NOT NULL, FORMAT(CRM_ACCOUNT.BIRTHDAY, 'dd/MM/yyyy'), '') BIRTHDAY,
            CRM_ACCOUNT.IDCARD,
            CRM_ACCOUNT.IDCARDBACKSIDE,
            CRM_ACCOUNT.IDCARDFRONTSIDE,
            CRM_ACCOUNT.LIVEIMAGE,
            IIF(CRM_ACCOUNT.IDCARDDATE IS NOT NULL, FORMAT(CRM_ACCOUNT.IDCARDDATE, 'dd/MM/yyyy'), '') IDCARDDATE,
            CRM_ACCOUNT.IDCARDPLACE
    FROM    CRM_ACCOUNT
    WHERE   CRM_ACCOUNT.ISACTIVE = 1
    AND     CRM_ACCOUNT.ISDELETED = 0
    AND     ISNULL(CRM_ACCOUNT.ISAFFILIATE, 0) = 0
    ORDER BY CRM_ACCOUNT.CUSTOMERCODE

    --DANH SACH LOAI AFFLIATE
    SELECT 
            AFF_AFFILIATETYPE.AFFILIATETYPEID VALUE,
            AFF_AFFILIATETYPE.AFFILIATETYPENAME LABEL
    FROM    AFF_AFFILIATETYPE
    WHERE   AFF_AFFILIATETYPE.ISACTIVE = 1
    AND     AFF_AFFILIATETYPE.ISDELETED = 0;

    --DANH SACH AFF LEADER
    SELECT 
            CRM_ACCOUNT.MEMBERID AS VALUE,
            CONCAT(CRM_ACCOUNT.CUSTOMERCODE, '-', CRM_ACCOUNT.FULLNAME) AS LABEL
    FROM    CRM_ACCOUNT
    WHERE   CRM_ACCOUNT.ISACTIVE = 1
    AND     CRM_ACCOUNT.ISDELETED = 0
    AND     CRM_ACCOUNT.ISAFFILIATE = 1

    --DANH SACH CHINH SACH
    SELECT 
            AFF_POLICYCOMMISION_TYPE.POLICYCOMMISIONTYPEID,
            AFF_POLICYCOMMISION_TYPE.POLICYCOMMISIONTYPENAME,
            AFF_POLICYCOMMISION_TYPE.POLICYCOMMISIONTYPEID AS VALUE,
            AFF_POLICYCOMMISION_TYPE.POLICYCOMMISIONTYPENAME AS LABEL,
            AFF_POLICYCOMMISION_TYPE.ISDEFAULT
    FROM    AFF_POLICYCOMMISION_TYPE
    WHERE   AFF_POLICYCOMMISION_TYPE.ISACTIVE = 1
    AND     AFF_POLICYCOMMISION_TYPE.ISDELETED = 0


END