ALTER PROCEDURE AFF_AFFILIATE_Report_AdminWeb
    @MEMBERID BIGINT = 0,
    @STARTDATE VARCHAR(20) = NULL,
    @ENDDATE VARCHAR(20) = NULL
AS 
BEGIN

    DECLARE @FROMDATE AS DATETIME = NULL,
            @TODATE AS DATETIME = NULL;

    IF(ISNULL(@STARTDATE, '') <> '') SET @FROMDATE = TRY_CONVERT(DATETIME, @STARTDATE, 103);
    IF(ISNULL(@ENDDATE, '') <> '') SET @TODATE = TRY_CONVERT(DATETIME, @ENDDATE, 103);

    SELECT 
            COUNT(1) AS TOTALORDER,
            0 TOTALREVENUE,
            0 TOTALCOMMISION
    FROM    SL_ORDER
    WHERE   SL_ORDER.ISDELETED = 0
    AND     SL_ORDER.ISACTIVE = 1
    AND     SL_ORDER.[STATUS] = 1
    AND     SL_ORDER.REFERRALCODE = @MEMBERID
    AND     (@FROMDATE IS NULL OR SL_ORDER.ORDERDATE >= @FROMDATE)
    AND     (@TODATE IS NULL OR SL_ORDER.ORDERDATE < @TODATE + 1)

    UNION

    SELECT 
            0 TOTALORDER,
            ISNULL(SUM(TOTALORDERVALUE),0) TOTALREVENUE,
            ISNULL(SUM(TOTALREFERRALVALUE),0) TOTALCOMMISION
    FROM    AFF_REFERRALINCOME
    WHERE   AFF_REFERRALINCOME.ISACTIVE = 0
    AND     AFF_REFERRALINCOME.MEMBERID = @MEMBERID
    AND     (@FROMDATE IS NULL OR AFF_REFERRALINCOME.CREATEDDATE >= @FROMDATE)
    AND     (@TODATE IS NULL OR AFF_REFERRALINCOME.CREATEDDATE < @TODATE + 1)     




END